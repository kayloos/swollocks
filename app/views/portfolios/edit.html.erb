<%= render 'stocks/index' %>
  <script type="text/javascript">
    // Trade forms events, tweaks and magic
    $(".plus, .minus").click(function(e){
      var trade = $(this).siblings(".trade");
      $.get(this.href, function(data) {
        trade.html(data);
        $(".stock_amount").focus();
  
        // Calculate cost when the user inserts amount
        $(".stock_amount").keyup(function(){
          amount = parseFloat($(this).val());
          traded_at = parseFloat($(this).parent().siblings("#stock_traded_at").val());
          if (amount > 0) {
            $(".cost").html(Math.round(amount * traded_at * 100) / 100);
          }
          else {
            $(".cost").html(0);
          }
          $(".stock_amount").html(0);
        });
  
        $("#new_stock, .edit_stock").submit(function(){
          trade.fadeOut(200);
          $("#box_focus").fadeOut(200);
        });
      });
      trade.modal();
      return false;
    });
  
    // Datatable initializing
    $("#quotes_table").dataTable({
      "bJQueryUI": true,
      "sPaginationType": "full_numbers",
      "iDisplayLength": 25,
      "aLengthMenu": [[25,50,100,-1],[25,50,100,"All"]],
      "aoColumns": [
        null, null, null,
        { "sType": "percent" }, null, null, null
      ]
    });
  </script>
